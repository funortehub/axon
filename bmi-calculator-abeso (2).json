{
  "id": "bmi-calculator-abeso",
  "name": "Calculadora de IMC (ABESO)",
  "author": "Axon Dev",
  "description": "Calcula o Índice de Massa Corporal (IMC) segundo as diretrizes da ABESO, com design de vidro líquido, animações fluídas e adaptação automática ao tema (claro/escuro) do sistema.",
  "icon": "https://cdn-icons-png.flaticon.com/512/6171/6171917.png",
  "version": "1.21",
  "html": "<style>\n    :root {\n        /* Dark Mode Defaults */\n        --text-color: #e2e8f0; /* Off-white/Gray */\n        --header-color: #f7fafc;\n        --highlight-color: #4299e1; /* Vibrant Blue */\n        --success-color: #68d391;\n        --error-color: #fc8181;\n        --warning-color-soft: orange; /* For overweight */\n        --warning-color-mild: yellow; /* For underweight */\n        --glass-bg: rgba(28, 35, 49, 0.5); /* Slightly more transparent */\n        --input-bg: rgba(0, 0, 0, 0.25); /* Slightly less opaque */\n        --border-subtle: rgba(255, 255, 255, 0.15); /* Slightly more visible */\n        --liquid-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4); /* Enhanced shadow */\n        --liquid-shadow-hover: 0 12px 40px 0 rgba(0, 0, 0, 0.5);\n        --liquid-gradient-start: #1a202c;\n        --liquid-gradient-end: #2d3748;\n    }\n\n    body.light-mode {\n        /* Light Mode Overrides */\n        --text-color: #2d3748; /* Darker gray */\n        --header-color: #1a202c; /* Even darker */\n        --highlight-color: #3182ce; /* A slightly darker blue for contrast */\n        --success-color: #38a169; /* Darker green */\n        --error-color: #e53e3e; /* Darker red */\n        --warning-color-soft: #dd6b20; /* Darker orange */\n        --warning-color-mild: #d69e2e; /* Darker yellow/gold */\n        --glass-bg: rgba(247, 250, 252, 0.6); /* Lighter background, more opaque */\n        --input-bg: rgba(237, 242, 247, 0.7); /* Lighter input bg */\n        --border-subtle: rgba(0, 0, 0, 0.1); /* Subtle dark border */\n        --liquid-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.15); /* Lighter shadow */\n        --liquid-shadow-hover: 0 12px 40px 0 rgba(0, 0, 0, 0.25);\n        --liquid-gradient-start: #f7fafc; /* Very light background */\n        --liquid-gradient-end: #edf2f7; /* Slightly darker light background */\n    }\n\n    body {\n        font-family: 'Consolas', 'Courier New', monospace;\n        background: linear-gradient(135deg, var(--liquid-gradient-start), var(--liquid-gradient-end));\n        background-size: 200% 200%;\n        animation: liquidBackground 15s ease infinite alternate;\n        color: var(--text-color);\n        height: 100vh;\n        overflow-y: auto;\n        padding: 5px;\n        box-sizing: border-box;\n        margin: 0;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        width: 100%;\n    }\n\n    @keyframes liquidBackground {\n        0% { background-position: 0% 50%; }\n        100% { background-position: 100% 50%; }\n    }\n\n    body::-webkit-scrollbar {\n        width: 6px;\n    }\n\n    body::-webkit-scrollbar-track {\n        background: rgba(0,0,0,0.1);\n    }\n\n    body::-webkit-scrollbar-thumb {\n        background-color: var(--border-subtle);\n        border-radius: 10px;\n    }\n\n    .container {\n        background: var(--glass-bg);\n        backdrop-filter: blur(20px) saturate(180%);\n        border-radius: 16px;\n        border: 1px solid var(--border-subtle);\n        box-shadow: var(--liquid-shadow);\n        padding: 15px;\n        width: 100%;\n        max-width: 360px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n        transition: all 0.3s ease;\n        margin-top: 5px;\n    }\n\n    .container:hover {\n        box-shadow: var(--liquid-shadow-hover);\n    }\n\n    h1 {\n        color: var(--header-color);\n        font-size: 1.2em;\n        margin-top: 0;\n        margin-bottom: 5px;\n        text-align: center;\n        text-shadow: 0 0 5px rgba(255,255,255,0.2); /* Subtle glow for dark mode */\n    }\n\n    body.light-mode h1 {\n        text-shadow: 0 0 3px rgba(0,0,0,0.1); /* Lighter glow for light mode */\n    }\n\n    .form-group {\n        margin-bottom: 8px;\n    }\n\n    label {\n        display: block;\n        margin-bottom: 4px;\n        color: var(--text-color);\n        font-size: 0.85em;\n    }\n\n    input[type=\"number\"] {\n        background: var(--input-bg);\n        border: 1px solid var(--border-subtle);\n        color: var(--text-color); /* Ensure input text color adapts */\n        padding: 8px 10px;\n        border-radius: 10px;\n        width: 100%;\n        box-sizing: border-box;\n        font-family: inherit;\n        font-size: 0.95em;\n        outline: none;\n        transition: all 0.3s ease;\n        box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);\n    }\n\n    input[type=\"number\"]:focus {\n        border-color: var(--highlight-color);\n        box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5), inset 0 1px 3px rgba(0,0,0,0.3);\n        background: rgba(0, 0, 0, 0.35); /* Darker on focus for dark mode */\n    }\n\n    body.light-mode input[type=\"number\"]:focus {\n        background: rgba(237, 242, 247, 0.9); /* Lighter on focus for light mode */\n        box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.4), inset 0 1px 3px rgba(0,0,0,0.2);\n    }\n\n    button {\n        background: var(--input-bg);\n        border: 1px solid var(--border-subtle);\n        color: var(--text-color);\n        padding: 8px 15px;\n        border-radius: 25px;\n        cursor: pointer;\n        font-family: inherit;\n        font-size: 0.95em;\n        transition: all 0.3s ease;\n        outline: none;\n        width: 100%;\n        box-sizing: border-box;\n        letter-spacing: 0.5px;\n        box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n    }\n\n    button:hover {\n        background: rgba(255, 255, 255, 0.15); /* More visible hover for dark mode */\n        border-color: var(--highlight-color);\n        color: var(--highlight-color);\n        transform: translateY(-2px);\n        box-shadow: 0 4px 10px rgba(66, 153, 225, 0.3);\n    }\n\n    body.light-mode button:hover {\n        background: rgba(200, 200, 200, 0.3); /* Lighter hover for light mode */\n        box-shadow: 0 4px 10px rgba(49, 130, 206, 0.2);\n    }\n\n    button:active {\n        transform: translateY(0);\n        box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n    }\n\n    #result {\n        background: var(--input-bg);\n        border: 1px dashed var(--border-subtle);\n        border-radius: 12px;\n        padding: 12px;\n        text-align: center;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-direction: column;\n        word-break: break-word;\n        gap: 5px;\n        transition: all 0.3s ease;\n    }\n    #result p {\n        margin: 0;\n        line-height: 1.3;\n    }\n    #result .bmi-value {\n        font-size: 1.5em;\n        color: var(--highlight-color);\n        font-weight: bold;\n        text-shadow: 0 0 8px rgba(66, 153, 225, 0.4); /* Glow for BMI value (dark) */\n    }\n    body.light-mode #result .bmi-value {\n        text-shadow: 0 0 5px rgba(49, 130, 206, 0.3);\n    }\n    #result .bmi-classification {\n        font-size: 1em;\n    }\n    .classification-normal { color: var(--success-color); text-shadow: 0 0 5px rgba(104, 211, 145, 0.3); }\n    body.light-mode .classification-normal { text-shadow: 0 0 5px rgba(56, 161, 105, 0.2); }\n\n    .classification-overweight { color: var(--warning-color-soft); text-shadow: 0 0 5px rgba(255, 165, 0, 0.3); }\n    body.light-mode .classification-overweight { color: var(--warning-color-soft); text-shadow: 0 0 5px rgba(221, 107, 32, 0.2); }\n\n    .classification-obese { color: var(--error-color); text-shadow: 0 0 5px rgba(252, 129, 129, 0.3); }\n    body.light-mode .classification-obese { color: var(--error-color); text-shadow: 0 0 5px rgba(197, 48, 48, 0.2); }\n\n    .classification-underweight { color: var(--warning-color-mild); text-shadow: 0 0 5px rgba(255, 255, 0, 0.3); }\n    body.light-mode .classification-underweight { color: var(--warning-color-mild); text-shadow: 0 0 5px rgba(214, 158, 46, 0.2); }\n</style>\n<div class=\"container\">\n    <h1>Calculadora de IMC (ABESO)</h1>\n    <div class=\"form-group\">\n        <label for=\"weight\">Peso (kg):</label>\n        <input type=\"number\" id=\"weight\" placeholder=\"Ex: 70.5\" step=\"0.1\" min=\"1\">\n    </div>\n    <div class=\"form-group\">\n        <label for=\"height\">Altura (cm):</label>\n        <input type=\"number\" id=\"height\" placeholder=\"Ex: 175\" step=\"1\" min=\"1\">\n    </div>\n    <button id=\"calculateBmi\">Calcular IMC</button>\n    <div id=\"result\">\n        <p>Preencha os campos e clique em 'Calcular IMC'.</p>\n    </div>\n    <button id=\"sendToChat\" style=\"margin-top: 3px; display: none;\">Enviar para o Chat</button>\n</div>\n<script>\n    document.addEventListener('DOMContentLoaded', () => {\n        const weightInput = document.getElementById('weight');\n        const heightInput = document.getElementById('height');\n        const calculateBtn = document.getElementById('calculateBmi');\n        const resultDiv = document.getElementById('result');\n        const sendToChatBtn = document.getElementById('sendToChat');\n\n        function applyTheme(isLight) {\n            if (isLight) {\n                document.body.classList.add('light-mode');\n                document.body.classList.remove('dark-mode');\n            } else {\n                document.body.classList.add('dark-mode');\n                document.body.classList.remove('light-mode');\n            }\n        }\n\n        // Initial theme detection based on system preference\n        const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;\n        applyTheme(prefersLight);\n\n        // Listen for changes in system preference\n        window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', event => {\n            applyTheme(event.matches);\n        });\n\n        // Listen for hypothetical Axon theme change messages (future-proofing)\n        window.addEventListener('message', (event) => {\n            if (event.data.type === 'AXON_THEME_CHANGE' && typeof event.data.theme === 'string') {\n                applyTheme(event.data.theme === 'light');\n            }\n\n            // Existing AxonPluginBridge responses (anamnesis)\n            if (event.data.type === 'AXON_PLUGIN_RESPONSE' && event.data.data && event.data.data.anamnesis) {\n                const anamnesis = event.data.data.anamnesis;\n                console.log(\"Anamnesis received:\", anamnesis);\n\n                const weightMatch = anamnesis.match(/Peso:\\s*([\\d.]+)\\s*kg/i);\n                const heightMatch = anamnesis.match(/Altura:\\s*([\\d.]+)\\s*cm/i);\n\n                if (weightMatch && weightMatch[1]) {\n                    weightInput.value = parseFloat(weightMatch[1]);\n                }\n                if (heightMatch && heightMatch[1]) {\n                    heightInput.value = parseFloat(heightMatch[1]);\n                }\n                if (weightInput.value && heightInput.value) {\n                    calculateBMI();\n                }\n            }\n        });\n\n        function calculateBMI() {\n            const weight = parseFloat(weightInput.value);\n            const heightCm = parseFloat(heightInput.value);\n\n            if (isNaN(weight) || isNaN(heightCm) || weight <= 0 || heightCm <= 0) {\n                resultDiv.innerHTML = '<p style=\"color: var(--error-color);\">Por favor, insira valores válidos para peso e altura.</p>';\n                sendToChatBtn.style.display = 'none';\n                return;\n            }\n\n            const heightM = heightCm / 100; // Convert cm to meters\n            const bmi = weight / (heightM * heightM);\n            const roundedBmi = bmi.toFixed(2);\n\n            let classification = '';\n            let classificationClass = '';\n\n            if (bmi < 18.5) {\n                classification = 'Abaixo do peso';\n                classificationClass = 'classification-underweight';\n            } else if (bmi >= 18.5 && bmi <= 24.9) {\n                classification = 'Peso normal';\n                classificationClass = 'classification-normal';\n            } else if (bmi >= 25.0 && bmi <= 29.9) {\n                classification = 'Sobrepeso';\n                classificationClass = 'classification-overweight';\n            } else if (bmi >= 30.0 && bmi <= 34.9) {\n                classification = 'Obesidade Grau I';\n                classificationClass = 'classification-obese';\n            } else if (bmi >= 35.0 && bmi <= 39.9) {\n                classification = 'Obesidade Grau II (severa)';\n                classificationClass = 'classification-obese';\n            } else { // bmi >= 40.0\n                classification = 'Obesidade Grau III (mórbida)';\n                classificationClass = 'classification-obese';\n            }\n\n            resultDiv.innerHTML = `\n                <p>Seu IMC é:</p>\n                <p class=\"bmi-value\">${roundedBmi}</p>\n                <p class=\"bmi-classification ${classificationClass}\">${classification}</p>\n            `;\n            sendToChatBtn.style.display = 'block';\n            sendToChatBtn.dataset.bmiResult = `IMC: ${roundedBmi} (${classification}). Peso: ${weight}kg, Altura: ${heightCm}cm.`\n        }\n\n        calculateBtn.addEventListener('click', calculateBMI);\n\n        sendToChatBtn.addEventListener('click', () => {\n            const resultMsg = sendToChatBtn.dataset.bmiResult;\n            if (resultMsg && window.AxonPluginBridge && window.AxonPluginBridge.sendToChat) {\n                window.AxonPluginBridge.sendToChat(resultMsg);\n            } else if (window.AxonPluginBridge && !window.AxonPluginBridge.sendToChat) {\n                console.warn(\"AxonPluginBridge.sendToChat is not available.\");\n                alert(\"A função de enviar para o chat não está disponível neste ambiente.\");\n            }\n        });\n\n        if (window.AxonPluginBridge && window.AxonPluginBridge.getAnamnesis) {\n            window.AxonPluginBridge.getAnamnesis();\n            // The 'message' listener above already handles the response.\n        }\n    });\n</script>"
}